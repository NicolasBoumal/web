<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing Firebase</title>
</head>
<body>

    <div id="signin-div" style="display: none">
        <button id="signin-button">Sign in</button>
    </div>
    <div id="signout-div" style="display: none">
        Signed in as <span id="user-name"></span>.
        <button id="signout-button">Sign out</button>
    </div>

    <!-- Insert this script at the bottom of the HTML, but before you use any Firebase services -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.9.4/firebase-app.js';

        // If you enabled Analytics in your project, add the Firebase SDK for Google Analytics
        // import { getAnalytics } from 'https://www.gstatic.com/firebasejs/9.9.4/firebase-analytics.js';

        // Add Firebase products that you want to use
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from 'https://www.gstatic.com/firebasejs/9.9.4/firebase-auth.js';
        import { getFirestore, collection, query, orderBy, limit, onSnapshot } from 'https://www.gstatic.com/firebasejs/9.9.4/firebase-firestore.js';

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyAbF2a_FSYjnN66_pQtxd8-cC9ba5wU9S8",
            authDomain: "arxiv-digest.firebaseapp.com",
            databaseURL: "https://arxiv-digest.firebaseio.com",
            projectId: "arxiv-digest",
            storageBucket: "arxiv-digest.appspot.com",
            messagingSenderId: "403410606061",
            appId: "1:403410606061:web:563052dd9b6e2caf1b39e4",
            measurementId: "G-CDYH5HPQ81"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        // const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore();

        async function signIn() {
            var provider = new GoogleAuthProvider();
            await signInWithPopup(getAuth(), provider);
        };
        function signOutUser() {
            signOut(getAuth());
        };

        function userIsSignedIn() {
            return !!getAuth().currentUser;
        }

        function authStateObserver(user) {
            if(user) {
                var userName = getAuth().currentUser.displayName;
                document.getElementById("user-name").innerText = userName;
                document.getElementById("signin-div").style.display = "none";
                document.getElementById("signout-div").style.display = "block";
            }
            else {
                document.getElementById("user-name").innerText = "";
                document.getElementById("signin-div").style.display = "block";
                document.getElementById("signout-div").style.display = "none";
            }
        }

        document.getElementById("signin-button").onclick = signIn;
        document.getElementById("signout-button").onclick = signOutUser;
        onAuthStateChanged(getAuth(), authStateObserver);
        authStateObserver(getAuth().currentUser);

    </script>
    
</body>
</html>
